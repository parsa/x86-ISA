<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.1//EN" "http://www.w3.org/TR/xhtml-basic/xhtml-basic11.dtd">
<html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<link rel="stylesheet" type="text/css" href="../assets/style.css" />
<title>LOCK: Assert LOCK# Signal Prefix (x86 Instruction Set Reference)</title>
<link rel="icon" type="image/ico" href="favicon.ico" />
<meta name="keywords"
content="assembly,asm,programming,optimization,optimisation,c,c++,x86,pastebin,opcode,opcodes,dictionary,intel,amd,download,downloads,tutorial" />
<meta name="description"
content="x86 assembly tutorials, x86 opcode reference, programming, pastebin with syntax highlighting" />
<meta name="robots" content="index, follow" />
<script async src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>
<script type="text/javascript" async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>
</head>
<body>
<div class="container"><h1 class="x86-instruction-set-reference">x86 Instruction Set Reference</h1>
<h2>LOCK - Assert LOCK# Signal Prefix</h2>
<object>
<table>
<tr>
<th>Opcode</th>
<th>Mnemonic</th>
<th>Description</th>
</tr>
<tr>
<td><code>F0</code></td>
<td><code>LOCK</code></td>
<td>Asserts LOCK# signal for duration of the accompanying</td>
</tr>
</table>
</object>
<object>
<table>
<tr>
<th>Description</th>
</tr>
<tr>
<td>
<p>Causes the processor's LOCK# signal to be asserted during execution of the accompanying instruction (turns the instruction into an atomic instruction). In a multiprocessor environment, the LOCK# signal insures that the processor has exclusive use of any shared memory while the signal is asserted.</p>
<p>Note that in later IA-32 processors (including the Pentium 4, Intel Xeon, and P6 family processors), locking may occur without the LOCK# signal being asserted. See IA-32 Architecture Compatibility below.</p>
<p>The LOCK prefix can be prepended only to the following instructions and only to those forms of the instructions where the destination operand is a memory operand: ADD, ADC, AND, BTC, BTR, BTS, CMPXCHG, CMPXCH8B, DEC, INC, NEG, NOT, OR, SBB, SUB, XOR, XADD, and XCHG. If the LOCK prefix is used with one of these instructions and the source operand is a memory operand, an undefined opcode exception (#UD) may be generated. An undefined opcode exception will also be generated if the LOCK prefix is used with any instruction not in the above list. The XCHG instruction always asserts the LOCK# signal regardless of the presence or absence of the LOCK prefix.</p>
<p>The LOCK prefix is typically used with the BTS instruction to perform a read-modify-write operation on a memory location in shared memory environment.</p>
<p>The integrity of the LOCK prefix is not affected by the alignment of the memory field. Memory locking is observed for arbitrarily misaligned fields.</p>
</td>
</tr>
</table>
</object>
<object>
<table>
<tr>
<th>Operation</th>
</tr>
<tr>
<td>
<pre class="prettyprint">AssertLOCK(DurationOfAccompaningInstruction);
</pre>
</td>
</tr>
</table>
</object>
<object>
<table>
<tr>
<th>Flags affected</th>
</tr>
<tr>
<td>
<p>None.
instruction.
</p>
</td>
</tr>
</table>
</object>
<object>
<table>
<tr>
<th>IA-32 Architecture Compatibility</th>
</tr>
<tr>
<td>
<p>Beginning with the P6 family processors, when the LOCK prefix is prefixed to an instruction and the memory area being accessed is cached internally in the processor, the LOCK# signal is generally not asserted. Instead, only the processor's cache is locked. Here, the processor's cache coherency mechanism insures that the operation is carried out atomically with regards to memory. See &quot;Effects of a Locked Operation on Internal Processor Caches&quot; in Chapter 7 of IA- 32 Intel Architecture Software Developer's Manual, Volume 3, the for more information on locking of caches.
</p>
</td>
</tr>
</table>
</object>
<object>
<table>
<tr>
<th>Protected Mode Exceptions</th>
</tr>
<tr>
<td>
<div>
<table>
<tr><td><code>#UD</code></td><td>If the LOCK prefix is used with an instruction not listed in the &quot;{description}&quot; section above. Other exceptions can be generated by the instruction that the LOCK prefix is being applied to.</td></tr>
</table>
</div>
</td>
</tr>
</table>
</object>
<object>
<table>
<tr>
<th>Real-Address Mode Exceptions</th>
</tr>
<tr>
<td>
<div>
<table>
<tr><td><code>#UD</code></td><td>If the LOCK prefix is used with an instruction not listed in the &quot;{description}&quot; section above. Other exceptions can be generated by the instruction that the LOCK prefix is being applied to.</td></tr>
</table>
</div>
</td>
</tr>
</table>
</object>
<object>
<table>
<tr>
<th>Virtual-8086 Mode Exceptions</th>
</tr>
<tr>
<td>
<div>
<table>
<tr><td><code>#UD</code></td><td>If the LOCK prefix is used with an instruction not listed in the &quot;{description}&quot; section above. Other exceptions can be generated by the instruction that the LOCK prefix is being applied to.</td></tr>
</table>
</div>
</td>
</tr>
</table>
</object>
</div>
</body>
</html>
